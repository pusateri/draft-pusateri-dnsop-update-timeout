<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>DNS TIMEOUT Resource Record</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
      /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
      a.info {
          /* This is the key. */
          position: relative;
          z-index: 24;
          text-decoration: none;
      }
      a.info:hover {
          z-index: 25;
          color: #FFF; background-color: #900;
      }
      a.info span { display: none; }
      a.info:hover span.info {
          /* The span will display just on :hover state. */
          display: block;
          position: absolute;
          font-size: smaller;
          top: 2em; left: -5em; width: 15em;
          padding: 2px; border: 1px solid #333;
          color: #900; background-color: #EEE;
          text-align: left;
      }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  max-width: 55em;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.2" rel="Chapter" title="2 Requirements Language">
<link href="#rfc.section.3" rel="Chapter" title="3 Sources of TIMEOUT Expiry Time">
<link href="#rfc.section.4" rel="Chapter" title="4 Resource Record Composition">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 Record Type">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 Hash Count">
<link href="#rfc.section.4.3" rel="Chapter" title="4.3 Hash Algorithm Index">
<link href="#rfc.section.4.4" rel="Chapter" title="4.4 Expiry Time">
<link href="#rfc.section.4.5" rel="Chapter" title="4.5 Cryptographic Hashes">
<link href="#rfc.section.5" rel="Chapter" title="5 Cryptographic Hash Requirements">
<link href="#rfc.section.5.1" rel="Chapter" title="5.1 REQUIRED Cryptographic Hash Algorithm">
<link href="#rfc.section.6" rel="Chapter" title="6 TIMEOUT RR RDATA Wire Format">
<link href="#rfc.section.7" rel="Chapter" title="7 Primary Server Behavior">
<link href="#rfc.section.8" rel="Chapter" title="8 Secondary Server Behavior">
<link href="#rfc.section.9" rel="Chapter" title="9 TIMEOUT RR RDATA Presentation Format">
<link href="#rfc.section.10" rel="Chapter" title="10 IANA Considerations">
<link href="#rfc.section.11" rel="Chapter" title="11 Security Considerations">
<link href="#rfc.section.12" rel="Chapter" title="12 Acknowledgments">
<link href="#rfc.references" rel="Chapter" title="13 References">
<link href="#rfc.references.1" rel="Chapter" title="13.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="13.2 Informative References">
<link href="#rfc.appendix.A" rel="Chapter" title="A Example TIMEOUT resource records">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content="xml2rfc version 2.20.1 - https://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Pusateri, T. and T. Wattenberg" />
  <meta name="dct.identifier" content="urn:ietf:id:draft-pusateri-dnsop-update-timeout-01" />
  <meta name="dct.issued" scheme="ISO8601" content="2019-02" />
  <meta name="dct.abstract" content="This specification defines a new DNS TIMEOUT resource record (RR) that associates a lifetime with one or more zone resource records with the same owner name, type, and class. It is intended to be used to transfer resource record lifetime state between a zone's primary and secondary servers and to store lifetime state during server software restarts." />
  <meta name="description" content="This specification defines a new DNS TIMEOUT resource record (RR) that associates a lifetime with one or more zone resource records with the same owner name, type, and class. It is intended to be used to transfer resource record lifetime state between a zone's primary and secondary servers and to store lifetime state during server software restarts." />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Internet Engineering Task Force</td>
<td class="right">T. Pusateri</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">T. Wattenberg</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">Unaffiliated</td>
</tr>
<tr>
<td class="left">Expires: September 3, 2019</td>
<td class="right">March 2, 2019</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">DNS TIMEOUT Resource Record<br />
  <span class="filename">draft-pusateri-dnsop-update-timeout-01</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This specification defines a new DNS TIMEOUT resource record (RR) that associates a lifetime with one or more zone resource records with the same owner name, type, and class. It is intended to be used to transfer resource record lifetime state between a zone's primary and secondary servers and to store lifetime state during server software restarts.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of This Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet-Drafts is at https://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on September 3, 2019.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2019 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (https://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>2.   <a href="#rfc.section.2">Requirements Language</a>
</li>
<li>3.   <a href="#rfc.section.3">Sources of TIMEOUT Expiry Time</a>
</li>
<li>4.   <a href="#rfc.section.4">Resource Record Composition</a>
</li>
<ul><li>4.1.   <a href="#rfc.section.4.1">Record Type</a>
</li>
<li>4.2.   <a href="#rfc.section.4.2">Hash Count</a>
</li>
<li>4.3.   <a href="#rfc.section.4.3">Hash Algorithm Index</a>
</li>
<li>4.4.   <a href="#rfc.section.4.4">Expiry Time</a>
</li>
<li>4.5.   <a href="#rfc.section.4.5">Cryptographic Hashes</a>
</li>
</ul><li>5.   <a href="#rfc.section.5">Cryptographic Hash Requirements</a>
</li>
<ul><li>5.1.   <a href="#rfc.section.5.1">REQUIRED Cryptographic Hash Algorithm</a>
</li>
</ul><li>6.   <a href="#rfc.section.6">TIMEOUT RR RDATA Wire Format</a>
</li>
<li>7.   <a href="#rfc.section.7">Primary Server Behavior</a>
</li>
<li>8.   <a href="#rfc.section.8">Secondary Server Behavior</a>
</li>
<li>9.   <a href="#rfc.section.9">TIMEOUT RR RDATA Presentation Format</a>
</li>
<li>10.   <a href="#rfc.section.10">IANA Considerations</a>
</li>
<li>11.   <a href="#rfc.section.11">Security Considerations</a>
</li>
<li>12.   <a href="#rfc.section.12">Acknowledgments</a>
</li>
<li>13.   <a href="#rfc.references">References</a>
</li>
<ul><li>13.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>13.2.   <a href="#rfc.references.2">Informative References</a>
</li>
</ul><li>Appendix A.   <a href="#rfc.appendix.A">Example TIMEOUT resource records</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Introduction</h1>
<p id="rfc.section.1.p.1">DNS Update <a href="#RFC2136" class="xref">[RFC2136]</a> provides a mechanism to dynamically add/remove DNS resource records to/from a zone. When a resource record is dynamically added, it remains in the zone until it is removed manually or via a subsequent DNS Update. A zone administrator may want to enforce a default lifetime for dynamic updates (such as the DHCP lease lifetime) or the DNS Update may contain a lifetime using an EDNS(0) Update Lease option <a href="#I-D.sekar-dns-ul" class="xref">[I-D.sekar-dns-ul]</a>. However, this lease lifetime is not communicated to secondary servers and will not endure through server software restarts. Therefore, this specification defines a new DNS TIMEOUT resource record that associates a lifetime with one or more resource records with the same owner name, type, and class that can be transferred to secondary servers through normal AXFR <a href="#RFC5936" class="xref">[RFC5936]</a>, IXFR <a href="#RFC1995" class="xref">[RFC1995]</a> transfer mechanisms.</p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> Requirements Language</h1>
<p id="rfc.section.2.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in BCP 14 <a href="#RFC2119" class="xref">[RFC2119]</a> <a href="#RFC8174" class="xref">[RFC8174]</a> when, and only when, they appear in all capitals, as shown here.  These words may also appear in this document in lower case as plain English words, absent their normative meanings.</p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> Sources of TIMEOUT Expiry Time</h1>
<p id="rfc.section.3.p.1">The expire time may come from many different sources. A few are listed here however, this list is not considered complete.  </p>

<ol>
<li>Via DHCP Dynamic Lease Lifetime communicated out of band.</li>
<li>Via EDNS(0) Update Lease option <a href="#I-D.sekar-dns-ul" class="xref">[I-D.sekar-dns-ul]</a> communicated in DNS Update.</li>
<li>Via an administrative default server value such as one day (86400 seconds).</li>
</ol>

<p> </p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> Resource Record Composition</h1>
<p id="rfc.section.4.p.1">The TIMEOUT resource record provides expiry times for a mixed variety of resource record types with the same owner name, type, and class. Since there could exist multiple records of the same record type with the same owner name and class, the TIMEOUT resource record must be able to identify each of these records individually with only different RDATA. As an example, PTR records for service discovery <a href="#RFC6763" class="xref">[RFC6763]</a> provide a level of indirection to SRV and TXT records by instance name. The instance name is stored in the PTR RDATA and multiple PTR records with the same owner name but only differing RDATA often exist.</p>
<p id="rfc.section.4.p.2">In order to distinguish each individual record with potentially different expiry times, the TIMEOUT resource record is made up of multiple lists of hashes of the records for which they are applicable. Each list has an expiry time associated with it and each hash corresponds to a resource record for which that expiry time applies. Each resource record represented by a hash in the list uses the same expiry time associated with the list. There is also a hash algorithm index associated with each list. All hashes in the list MUST use the same hash algorithm.</p>
<p id="rfc.section.4.p.3">Since each TIMEOUT resource record is actually a collection of state from different sources over different time periods, there is a potential for default algorithm changes to occur on a single server or due to unavailability of an UPDATE server for a period of time to merge records between failover servers with different default algorithms. Therefore, the ability to have different hash algorithms in the same TIMEOUT resource record is accounted for. While this won't be a common scenario, it could occur during failure and restart scenarios. All hashes for the same expiry time MUST use the same hash algorithm. This is not likely to cause any problems with merging since the same server will be using the same default hash algorithm at a particular second resolution in time.</p>
<p id="rfc.section.4.p.4">Within the TIMEOUT resource record there can exist an arbitrary number of combinations of applicable Record Type, Hash Algorithm Index, Hash Count, Expiry Time, and list of zero or more cryptographic hashes. The specific fields and their values are defined as:</p>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> Record Type</h1>
<p id="rfc.section.4.1.p.1">A 16-bit field containing the resource record type to which the TIMEOUT record applies. Multiple TIMEOUT records for the same owner name can exist (one for each record type, class combination).</p>
<h1 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> Hash Count</h1>
<p id="rfc.section.4.2.p.1">The Hash Count is a 8-bit value that specifies the number of hash values for the instance. All hashes within the instance MUST use the same Hash Algorithm specified by the Hash Algorithm Index.</p>
<p id="rfc.section.4.2.p.2">A Hash Count of 0 indicates that no hashes are contained in the list. This is a shortcut notation meaning all resource records with the same owner name, record type, and class use the same Expiry Time. There MUST be only one instance of Hash Count and Hash Algorithm Index in this case. When the Hash Count is 0, the Hash Algorithm Index is set to NOHASH (0) on transmission and ignored on reception.</p>
<p id="rfc.section.4.2.p.3">In the unlikely event that the Hash Count exceeds 255 which is the largest number representable in 8 bits, multiple instances of the same Expiry Time can exist.</p>
<h1 id="rfc.section.4.3">
<a href="#rfc.section.4.3">4.3.</a> <a href="#HashIndex" id="HashIndex">Hash Algorithm Index</a>
</h1>
<p id="rfc.section.4.3.p.1">The Hash Algorithm Index is a 8-bit value that specifies an identifier for the hash algorithm used. The indexes are declared in a registry maintained by IANA for the purpose of listing acceptable hash algorithms for this purpose. In addition to the algorithm and the index, the registry will contain the output length in bits of the algorithm to be used. It is conceivable, though not likely, that the same algorithm could be used with different output lengths. In this case, each output length would require a different index in the registry. Additions to this registry will be approved with additional documentation under expert review. At the time that the registry is created by IANA, a group of expert reviewers will be established.</p>
<p id="rfc.section.4.3.p.2">The Hash Algorithm Index of 0 is defined as NOHASH and MUST NOT be used if any hash values are present in the instance. The index value of 0 is to be included in the IANA registry of Hash Algorithm Index values.</p>
<h1 id="rfc.section.4.4">
<a href="#rfc.section.4.4">4.4.</a> Expiry Time</h1>
<p id="rfc.section.4.4.p.1">The expiry time is a 64-bit number expressed as the number of seconds since the UNIX epoch (00:00:00 UTC on January 1, 1970). This value is an absolute time at which the record will expire. Lease times must be converted to an absolute expiry time when received.</p>
<h1 id="rfc.section.4.5">
<a href="#rfc.section.4.5">4.5.</a> Cryptographic Hashes</h1>
<p id="rfc.section.4.5.p.1">The hash of each resource record is calculated using the entire length of the resource record as input. The output value of the hash is always a fixed pre-defined length specified with the hash algorithm registry. Before calculating the hash, the record MUST be in canonical DNSSEC form as described in Section 6 of <a href="#RFC4034" class="xref">[RFC4034]</a>.</p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> Cryptographic Hash Requirements</h1>
<p id="rfc.section.5.p.1">The cryptographic hash algorithm used SHOULD provide the following properties: </p>

<ol>
<li>Well known algorithm with implementations easily available.</li>
<li>Trusted algorithm with resistance to collision attacks.</li>
<li>Minimize output length for efficient storage in the TIMEOUT resource record.</li>
</ol>

<p> </p>
<p id="rfc.section.5.p.2">While computational complexity is always a consideration when selecting algorithms, the frequency of this calculation is intended to be low volume and, therefore, this property is of reduced importance.</p>
<h1 id="rfc.section.5.1">
<a href="#rfc.section.5.1">5.1.</a> <a href="#SHAKE128" id="SHAKE128">REQUIRED Cryptographic Hash Algorithm</a>
</h1>
<p id="rfc.section.5.1.p.1">The initial algorithm selected to meet this criteria is SHAKE128. It is part of the SHA-3 <a href="#SHA3" class="xref">[SHA3]</a> family of cryptographic hash algorithms. The output length of the hash used is 128 bits or 16 bytes. SHAKE128 is implemented in the OpenSSL Library version 1.1.1 <a href="#OPENSSL" class="xref">[OPENSSL]</a>. In order to be in compliance with this specification, the SHAKE128 algorithm MUST be implemented. SHAKE128 is to be assigned an algorithm index of 1 in the IANA registry.</p>
<p id="rfc.section.5.1.p.2">Additional algorithms may be defined in the future that can be used in place of SHAKE128.</p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> TIMEOUT RR RDATA Wire Format</h1>
<p id="rfc.section.6.p.1">The TIMEOUT resource record follows the same pattern as other DNS resource records as defined in Section 3.2.1 of <a href="#RFC1035" class="xref">[RFC1035]</a>.</p>
<p id="rfc.section.6.p.2">The RDATA section of the resource record is illustrated in <a href="#rr_art" class="xref">Figure 1</a>:</p>
<div id="rfc.figure.1"></div>
<div id="rr_art"></div>
<pre>
        
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|             RR Type           |  Count A (n)  |  Algorithm A  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                      Expiry Time A (64-bit)                   |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
.                                                               .
.                            Hash A-1                           .
.                                                               .
.                                                               .
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
.                                                               .
.                            Hash A-n                           .
.                                                               .
.                                                               .
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|             RR Type           |  Count B (m)  |  Algorithm B  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                      Expiry Time B (64-bit)                   |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
.                                                               .
.                            Hash B-1                           .
.                                                               .
.                                                               .
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
.                                                               .
.                            Hash B-m                           .
.                                                               .
.                                                               .
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        
        </pre>
<p class="figure">Figure 1: RDATA Wire Format</p>
<p><a href="#rr_art" class="xref">Figure 1</a> represents an arbitrary number of combinations of applicable Record Type, Hash Count, Hash Algorithm Index, Expiry Time, and list of zero or more cryptographic hashes. The figure entries containing "A" in the name represent one instance while the figure entries containing "B" in the name represent a second instance. There can be an arbitrary number of instances whose byte counts are accumulated by the RDLEN field in the resource record header.</p>
<p id="rfc.section.6.p.4">The letter "n" represents the Hash Count in the first instance where there exists 0..n cryptographic hashes in the list. The letter "m" represents the Hash Count in the second instance where there exists 0..m cryptographic hashes in the second list. Either "n" or "m" could be zero.</p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> Primary Server Behavior</h1>
<p id="rfc.section.7.p.1">A TIMEOUT resource record MUST be removed when the last resource record it covers has been removed. This may be due to the record expiring (reaching the expiry time) or due to a subsequent DNS Update or administrative action.</p>
<p id="rfc.section.7.p.2">Upon receiving any DNS UPDATE deleting resource records that might have been covered by a TIMEOUT RR, a primary server MUST go through all instances within the TIMEOUT RR and delete all hashes matching the relevant resource records.</p>
<p id="rfc.section.7.p.3">As a reminder from Section 3.3.13 of <a href="#RFC1035" class="xref">[RFC1035]</a>, the MINIMUM field of the SOA for the zone is used as a lower bound of the TTL for all records in the zone. Therefore, even if the TIMEOUT record will expire in less time than the MINIMUM, the TTL is still set to the MINIMUM for records covered by the TIMEOUT record and the TIMEOUT record itself when a response is returned by an authoritative server. The TIMEOUT RR is mostly for the benefit of the authoritative server to know when to remove the records. The fact that some records might live longer in the cache of a resolver is no different than other records that might get removed while still in a remote resolver cache.</p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> Secondary Server Behavior</h1>
<p id="rfc.section.8.p.1">A secondary server may or may not understand TIMEOUT resource records. If a secondary server does not understand them, they are treated like any other resource record that the server may not understand <a href="#RFC3597" class="xref">[RFC3597]</a>.</p>
<p id="rfc.section.8.p.2">A secondary server MUST NOT expire the records in a zone it maintains covered by the TIMEOUT resource record and it MUST NOT expire the TIMEOUT resource record itself when the last record it covers has expired. The secondary server MUST always wait for the records to be removed or updated by the primary server.</p>
<h1 id="rfc.section.9">
<a href="#rfc.section.9">9.</a> TIMEOUT RR RDATA Presentation Format</h1>
<p></p>

<dl>
<dt>Record Type:</dt>
<dd style="margin-left: 6">
<br> resource record type mnemonics.  When the mnemonic is unknown, the TYPE representation described in Section 5 of <a href="#RFC3597" class="xref">[RFC3597]</a>
</dd>
<dt>Hash Count:</dt>
<dd style="margin-left: 6">
<br> unsigned decimal integer</dd>
<dt>Hash Algorithm index:</dt>
<dd style="margin-left: 6">
<br> unsigned decimal integer</dd>
<dt>Expiry Time:</dt>
<dd style="margin-left: 6">
<br> Internet Date/Time Format from <a href="#RFC3339" class="xref">[RFC3339]</a> Section 5.6 profile of ISO 8601 basic notation</dd>
<dt>Hash:</dt>
<dd style="margin-left: 6">
<br> Base64 encoding (whitespace allowed), Section 4 of <a href="#RFC4648" class="xref">[RFC4648]</a>
</dd>
</dl>

<p> </p>
<h1 id="rfc.section.10">
<a href="#rfc.section.10">10.</a> <a href="#IANA" id="IANA">IANA Considerations</a>
</h1>
<p id="rfc.section.10.p.1">This document defines a new DNS Resource Record Type named TIMEOUT to be exchanged between authoritative primary and secondary DNS servers. It is assigned out of the DNS Parameters Resource Record (RR) Type registry. The value for the TIMEOUT resource record type is TBA.</p>
<p id="rfc.section.10.p.2">This document establishes a new registry of DNS TIMEOUT Resource Record Cryptographic Hash Algorithm Index values. The registry shall include an index, an index name, the name of the algorithm, and the length of the output function in bits. The index is to be used in the RDATA section of the TIMEOUT resource record.</p>
<div id="rfc.table.1"></div>
<div id="table_algs"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<caption>TIMEOUT RR Hash Algorithm Index values</caption>
<thead><tr>
<th class="center">Index</th>
<th class="left">Name</th>
<th class="left">Algorithm</th>
<th class="center">Length (bits)</th>
<th class="left">Definition</th>
</tr></thead>
<tbody>
<tr>
<td class="center">0</td>
<td class="left">NOHASH</td>
<td class="left"></td>
<td class="center">0</td>
<td class="left"><a href="#HashIndex" class="xref">Section 4.3</a></td>
</tr>
<tr>
<td class="center">1</td>
<td class="left">SHAKE128</td>
<td class="left">SHAKE128</td>
<td class="center">128</td>
<td class="left"><a href="#SHAKE128" class="xref">Section 5.1</a></td>
</tr>
</tbody>
</table>
<h1 id="rfc.section.11">
<a href="#rfc.section.11">11.</a> <a href="#Security" id="Security">Security Considerations</a>
</h1>
<p id="rfc.section.11.p.1">Vulnerabilities in cryptographic hash algorithms may become known over time. This specification only defines one well respected algorithm (SHAKE128) for hashing resource records to maximize interoperability. The IANA registry is defined for the future when vulnerabilities are found in this algorithm. Until that point, there likely will not exist a need to add new hash algorithms to the registry.</p>
<h1 id="rfc.section.12">
<a href="#rfc.section.12">12.</a> <a href="#Acknowledgments" id="Acknowledgments">Acknowledgments</a>
</h1>
<p id="rfc.section.12.p.1">This idea was motivated through conversations with Mark Andrews. Thanks to Mark as well as Paul Vixie, Joe Abley, and Ted Lemon for their suggestions, review, and comments.</p>
<p></p>
<h1 id="rfc.references">
<a href="#rfc.references">13.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">13.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC1035">[RFC1035]</b></td>
<td class="top">
<a>Mockapetris, P.</a>, "<a href="https://tools.ietf.org/html/rfc1035">Domain names - implementation and specification</a>", STD 13, RFC 1035, DOI 10.17487/RFC1035, November 1987.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a>Bradner, S.</a>, "<a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, DOI 10.17487/RFC2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3339">[RFC3339]</b></td>
<td class="top">
<a>Klyne, G.</a> and <a>C. Newman</a>, "<a href="https://tools.ietf.org/html/rfc3339">Date and Time on the Internet: Timestamps</a>", RFC 3339, DOI 10.17487/RFC3339, July 2002.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3597">[RFC3597]</b></td>
<td class="top">
<a>Gustafsson, A.</a>, "<a href="https://tools.ietf.org/html/rfc3597">Handling of Unknown DNS Resource Record (RR) Types</a>", RFC 3597, DOI 10.17487/RFC3597, September 2003.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4034">[RFC4034]</b></td>
<td class="top">
<a>Arends, R.</a>, <a>Austein, R.</a>, <a>Larson, M.</a>, <a>Massey, D.</a> and <a>S. Rose</a>, "<a href="https://tools.ietf.org/html/rfc4034">Resource Records for the DNS Security Extensions</a>", RFC 4034, DOI 10.17487/RFC4034, March 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4648">[RFC4648]</b></td>
<td class="top">
<a>Josefsson, S.</a>, "<a href="https://tools.ietf.org/html/rfc4648">The Base16, Base32, and Base64 Data Encodings</a>", RFC 4648, DOI 10.17487/RFC4648, October 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8174">[RFC8174]</b></td>
<td class="top">
<a>Leiba, B.</a>, "<a href="https://tools.ietf.org/html/rfc8174">Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</a>", BCP 14, RFC 8174, DOI 10.17487/RFC8174, May 2017.</td>
</tr>
<tr>
<td class="reference"><b id="SHA3">[SHA3]</b></td>
<td class="top">
<a>National Institute of Standards and Technology</a>, "<a href="https://www.nist.gov/publications/sha-3-standard-permutation-based-hash-and-extendable-output-functions">SHA-3 Standard - Permutation-Based Hash and Extendable-Output Functions FIPS PUB 202</a>", August 2015.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">13.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="I-D.sekar-dns-ul">[I-D.sekar-dns-ul]</b></td>
<td class="top">
<a>Cheshire, S.</a> and <a>T. Lemon</a>, "<a href="https://tools.ietf.org/html/draft-sekar-dns-ul-02">Dynamic DNS Update Leases</a>", Internet-Draft draft-sekar-dns-ul-02, August 2018.</td>
</tr>
<tr>
<td class="reference"><b id="OPENSSL">[OPENSSL]</b></td>
<td class="top">
<a>OpenSSL Software Foundation</a>, "<a href="https://www.openssl.org">OpenSSL: Cryptography and SSL/TLS Toolkit</a>", October 2017.</td>
</tr>
<tr>
<td class="reference"><b id="RFC1995">[RFC1995]</b></td>
<td class="top">
<a>Ohta, M.</a>, "<a href="https://tools.ietf.org/html/rfc1995">Incremental Zone Transfer in DNS</a>", RFC 1995, DOI 10.17487/RFC1995, August 1996.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2136">[RFC2136]</b></td>
<td class="top">
<a>Vixie, P.</a>, <a>Thomson, S.</a>, <a>Rekhter, Y.</a> and <a>J. Bound</a>, "<a href="https://tools.ietf.org/html/rfc2136">Dynamic Updates in the Domain Name System (DNS UPDATE)</a>", RFC 2136, DOI 10.17487/RFC2136, April 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5936">[RFC5936]</b></td>
<td class="top">
<a>Lewis, E.</a> and <a>A. Hoenes</a>, "<a href="https://tools.ietf.org/html/rfc5936">DNS Zone Transfer Protocol (AXFR)</a>", RFC 5936, DOI 10.17487/RFC5936, June 2010.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6763">[RFC6763]</b></td>
<td class="top">
<a>Cheshire, S.</a> and <a>M. Krochmal</a>, "<a href="https://tools.ietf.org/html/rfc6763">DNS-Based Service Discovery</a>", RFC 6763, DOI 10.17487/RFC6763, February 2013.</td>
</tr>
</tbody></table>
<h1 id="rfc.appendix.A">
<a href="#rfc.appendix.A">Appendix A.</a> Example TIMEOUT resource records</h1>
<p id="rfc.section.A.p.1">The following example shows sample TIMEOUT resource records based on DNS UPDATEs containing A and AAAA address records plus the corresponding PTR records.</p>
<p id="rfc.section.A.p.2">A host sending a name registration at time Tn for <samp>A</samp> and <samp>AAAA</samp> records with lease lifetime Ln would have a series of UPDATEs (one for each zone) that contain:</p>
<div id="rfc.table.2"></div>
<div id="address_update"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<caption>Example Address Records Update</caption>
<thead><tr>
<th class="left">Name</th>
<th class="left">RR Type</th>
<th class="left">Value</th>
</tr></thead>
<tbody>
<tr>
<td class="left">name.example.com.</td>
<td class="left">A</td>
<td class="left">192.0.2.5</td>
</tr>
<tr>
<td class="left">name.example.com.</td>
<td class="left">AAAA</td>
<td class="left">12001:db8::5</td>
</tr>
<tr>
<td class="left">5.2.0.192.in-addr.arpa.</td>
<td class="left">PTR</td>
<td class="left">name.example.com.</td>
</tr>
<tr>
<td class="left">5.0.0.0.0.0.0.0.0.0.0.0.b8.0d.01.20.ip6.arpa. (bytes)</td>
<td class="left">PTR</td>
<td class="left">name.example.com.</td>
</tr>
</tbody>
</table>
<p id="rfc.section.A.p.3">Next, consider the TIMEOUT resource records that would be generated for the records in <a href="#address_update" class="xref">Table 2</a>. Notice that none of the 4 TIMEOUT records on the server would require a hash:</p>
<div id="rfc.table.3"></div>
<div id="address_timeout"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<caption>Address TIMEOUT records</caption>
<thead><tr>
<th class="left">Owner Name</th>
<th class="left">For Type</th>
<th class="left">Count</th>
<th class="left">Alg</th>
<th class="left">Expiration</th>
</tr></thead>
<tbody>
<tr>
<td class="left">name.example.com.</td>
<td class="left">A</td>
<td class="left">0</td>
<td class="left">0</td>
<td class="left">Tn + Ln</td>
</tr>
<tr>
<td class="left">name.example.com.</td>
<td class="left">AAAA</td>
<td class="left">0</td>
<td class="left">0</td>
<td class="left">Tn + Ln</td>
</tr>
<tr>
<td class="left">5.2.0.192.in-addr.arpa.</td>
<td class="left">PTR</td>
<td class="left">0</td>
<td class="left">0</td>
<td class="left">Tn + Ln</td>
</tr>
<tr>
<td class="left">5.0.0.0.0.0.0.0.0.0.0.0.b8.0d.01.20.ip6.arpa. (bytes)</td>
<td class="left">PTR</td>
<td class="left">0</td>
<td class="left">0</td>
<td class="left">Tn + Ln</td>
</tr>
</tbody>
</table>
<p id="rfc.section.A.p.4">Next, assume there are two hosts advertising the same service type (different service types will have different owner names). We will use _ipp._tcp.example.com as an example.</p>
<p id="rfc.section.A.p.5">Host A sends an UPDATE at time Ta with lease life La for PTR, SRV, A, AAAA, and TXT records. Host B sends an UPDATE at time Tb with lease life Lb for PTR, SRV, A, and TXT records.</p>
<div id="rfc.table.4"></div>
<div id="ipp_host_a"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<caption>DNS UPDATE from Host A</caption>
<thead><tr>
<th class="left">Owner name</th>
<th class="left">RR Type</th>
<th class="left">Value</th>
</tr></thead>
<tbody>
<tr>
<td class="left">_ipp._tcp.example.com.</td>
<td class="left">PTR</td>
<td class="left">p1._ipp._tcp.example.com.</td>
</tr>
<tr>
<td class="left">p1._ipp._tcp.example.com.</td>
<td class="left">SRV</td>
<td class="left">0 0 631 p1.example.com.</td>
</tr>
<tr>
<td class="left">p1._ipp._tcp.example.com.</td>
<td class="left">TXT</td>
<td class="left">paper=A4</td>
</tr>
<tr>
<td class="left">p1.example.com.</td>
<td class="left">A</td>
<td class="left">192.0.2.1</td>
</tr>
<tr>
<td class="left">p1.example.com.</td>
<td class="left">AAAA</td>
<td class="left">2001:db8::1</td>
</tr>
</tbody>
</table>
<div id="rfc.table.5"></div>
<div id="ipp_host_b"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<caption>DNS UPDATE from Host B</caption>
<thead><tr>
<th class="left">Owner name</th>
<th class="left">RR Type</th>
<th class="left">Value</th>
</tr></thead>
<tbody>
<tr>
<td class="left">_ipp._tcp.example.com.</td>
<td class="left">PTR</td>
<td class="left">p2._ipp._tcp.example.com.</td>
</tr>
<tr>
<td class="left">p2._ipp._tcp.example.com.</td>
<td class="left">SRV</td>
<td class="left">0 0 631 p2.example.com.</td>
</tr>
<tr>
<td class="left">p2._ipp._tcp.example.com.</td>
<td class="left">TXT</td>
<td class="left">paper=B4</td>
</tr>
<tr>
<td class="left">p2.example.com.</td>
<td class="left">A</td>
<td class="left">192.0.2.2</td>
</tr>
</tbody>
</table>
<p id="rfc.section.A.p.6">For these printer registrations, the TIMEOUT records on the server would look like the following:</p>
<div id="rfc.table.6"></div>
<div id="printer_timeout"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<caption>Service TIMEOUT records</caption>
<thead><tr>
<th class="left">Owner Name</th>
<th class="left">For Type</th>
<th class="left">Count</th>
<th class="left">Alg</th>
<th class="left">Expire /       Hash List</th>
</tr></thead>
<tbody>
<tr>
<td class="left">_ipp.tcp.example.com.</td>
<td class="left">PTR</td>
<td class="left">1</td>
<td class="left">1</td>
<td class="left">Ta + La&#160;           7ba17d11f8d96bb5 4b7ca675bebaf1b6</td>
</tr>
<tr>
<td class="left"></td>
<td class="left"></td>
<td class="left">1</td>
<td class="left">1</td>
<td class="left">Tb + Lb&#160;           644685a489ad3bd4 350c1230c7643745</td>
</tr>
<tr>
<td class="left">p1._ipp._tcp.example.com.</td>
<td class="left">SRV</td>
<td class="left">0</td>
<td class="left">0</td>
<td class="left">Ta + La</td>
</tr>
<tr>
<td class="left">p1._ipp._tcp.example.com.</td>
<td class="left">TXT</td>
<td class="left">0</td>
<td class="left">0</td>
<td class="left">Ta + La</td>
</tr>
<tr>
<td class="left">p2._ipp._tcp.example.com.</td>
<td class="left">SRV</td>
<td class="left">0</td>
<td class="left">0</td>
<td class="left">Tb + Lb</td>
</tr>
<tr>
<td class="left">p2._ipp._tcp.example.com.</td>
<td class="left">TXT</td>
<td class="left">0</td>
<td class="left">0</td>
<td class="left">Tb + Lb</td>
</tr>
<tr>
<td class="left">p1.example.com.</td>
<td class="left">A</td>
<td class="left">0</td>
<td class="left">0</td>
<td class="left">Ta + La</td>
</tr>
<tr>
<td class="left">p1.example.com.</td>
<td class="left">AAAA</td>
<td class="left">0</td>
<td class="left">0</td>
<td class="left">Ta + La</td>
</tr>
<tr>
<td class="left">p2.example.com.</td>
<td class="left">A</td>
<td class="left">0</td>
<td class="left">0</td>
<td class="left">Tb + Lb</td>
</tr>
</tbody>
</table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Tom Pusateri</span> 
	  <span class="n hidden">
		<span class="family-name">Pusateri</span>
	  </span>
	</span>
	<span class="org vcardline">Unaffiliated</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality">Raleigh</span>,  
		<span class="region">NC</span> 
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:pusateri@bangj.com">pusateri@bangj.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Tim Wattenberg</span> 
	  <span class="n hidden">
		<span class="family-name">Wattenberg</span>
	  </span>
	</span>
	<span class="org vcardline">Unaffiliated</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality">Cologne</span>,  
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline">Germany</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:mail@timwattenberg.de">mail@timwattenberg.de</a></span>

  </address>
</div>

</body>
</html>
