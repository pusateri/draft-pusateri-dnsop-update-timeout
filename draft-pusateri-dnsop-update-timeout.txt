



Internet Engineering Task Force                              T. Pusateri
Internet-Draft                                             T. Wattenberg
Intended status: Standards Track                            Unaffiliated
Expires: February 3, 2019                                 August 2, 2018


                      DNS TIMEOUT Resource Record
                 draft-pusateri-dnsop-update-timeout-00

Abstract

   This specification defines a new DNS TIMEOUT resource record that
   associates a lifetime with one or more zone resource records with the
   same owner name and class.  It is intended to be used to transfer
   resource record lifetime state between a zone's primary and secondary
   servers and to store lifetime state during server software restarts.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on February 3, 2019.

Copyright Notice

   Copyright (c) 2018 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (https://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.



Pusateri & Wattenberg   Expires February 3, 2019                [Page 1]

Internet-Draft           TIMEOUT Resource Record             August 2018


Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
     1.1.  Requirements Language . . . . . . . . . . . . . . . . . .   2
   2.  Timeout Resource Record Properties  . . . . . . . . . . . . .   3
   3.  Secondary Server Behavior . . . . . . . . . . . . . . . . . .   3
   4.  Sources of TIMEOUT Expiry Time  . . . . . . . . . . . . . . .   4
   5.  Resource Record Composition . . . . . . . . . . . . . . . . .   4
     5.1.  Expiry Time . . . . . . . . . . . . . . . . . . . . . . .   5
     5.2.  Hash Algorithm Index  . . . . . . . . . . . . . . . . . .   5
     5.3.  Hash values . . . . . . . . . . . . . . . . . . . . . . .   5
     5.4.  Hash Requirements and Deafult Algorithm Selection . . . .   5
   6.  TIMEOUT RR RDATA Wire Format  . . . . . . . . . . . . . . . .   6
   7.  TIMEOUT RR RDATA Presentation Format  . . . . . . . . . . . .   8
   8.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .   8
   9.  Security Considerations . . . . . . . . . . . . . . . . . . .   8
   10. Acknowledgements  . . . . . . . . . . . . . . . . . . . . . .   8
   11. References  . . . . . . . . . . . . . . . . . . . . . . . . .   8
     11.1.  Normative References . . . . . . . . . . . . . . . . . .   8
     11.2.  Informative References . . . . . . . . . . . . . . . . .   9
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .   9

1.  Introduction

   DNS Update [RFC2136] provides a mechanism to dynamically add/remove
   DNS resource records to/from a zone.  When a resource record is
   dynamically added, it remains in the zone until it is removed
   manually or via a subsequent DNS Update.  A zone administrator may
   want to enforce a default lifetime for dynamic updates (such as the
   DHCP lease lifetime) or the DNS Update may contain a lifetime using
   an EDNS(0) Update Lease option [I-D.sekar-dns-ul].  This lease
   lifetime is not communicated to secondary servers and will not endure
   through server software restarts.  This specification defines a new
   DNS TIMEOUT resource record that associates a lifetime with one or
   more resource records with the same owner name and class that can be
   transferred to secondary servers through normal AXFR, IXFR transfer
   mechanisms.

1.1.  Requirements Language

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in RFC 2119 [RFC2119].








Pusateri & Wattenberg   Expires February 3, 2019                [Page 2]

Internet-Draft           TIMEOUT Resource Record             August 2018


2.  Timeout Resource Record Properties

   TIMEOUT resource records have different properties than normal DNS
   resource records.

   1.  TIMEOUT resource records are only defined for CLASS IN.

   2.  TIMEOUT resource records are only for administrative use and they
       cannot be directly queried via the normal DNS request/response
       query mechanism.  Valid requests for TIMEOUT resource record
       types MUST return responses with an NOERROR RCODE and an ANSWER
       COUNT of zero.

   3.  TIMEOUT resource records are not automatically sent in AXFR, IXFR
       zone transfer requests.  Both primary and secondary servers
       should be configured on a per zone basis to transfer TIMEOUT
       resource records to ensure they are supported.

   4.  TIMEOUT resource records are not considered for
       DNSSEC/NSEC/NSEC3/NSEC5 record construction.

   5.  TIMEOUT resource records cannot be directly added, modified, or
       deleted through DNS Update.

   6.  A TIMEOUT resource record MUST be removed when the last resource
       record it covers has been removed.  This may be due to the record
       expiring (reaching the expiry time) or due to a subsequent DNS
       Update or administrative action.

3.  Secondary Server Behavior

   A secondary or slave server may or may not understand TIMEOUT
   resource records.  The primary or master server should not be
   configured to send TIMEOUT resource records if the secondary or slave
   server does not understand them.  However, if TIMEOUT resource
   records are mistakenly transferred to a server that does not
   understand them, they are treated like any other resource record that
   the server may not understand [RFC3597].

   A secondary server that does understand the TIMEOUT resource records
   it receives in a transfer MUST abide by the properties of the
   resource record type defined in Section 2.

   A secondary server will independently expire the records in a zone it
   maintains covered by the TIMEOUT resource record as well as expire
   the TIMEOUT resource record itself when the last record it covers has
   expired in the same manner that a primary server would.




Pusateri & Wattenberg   Expires February 3, 2019                [Page 3]

Internet-Draft           TIMEOUT Resource Record             August 2018


   If a TIMEOUT resource record is removed from a subsequent zone
   transfer, the secondary server MUST also remove it from its zone
   database regardless of the expiry time.

4.  Sources of TIMEOUT Expiry Time

   The expire time may come from many different sources.  A few are
   listed here however, this list is not considered complete.

   1.  Via DHCP Dynamic Lease Lifetime communicated out of band.

   2.  Via EDNS(0) Update Lease option [I-D.sekar-dns-ul] communicated
       in DNS Update.

   3.  Via an administrative default server value such as one day (86400
       seconds).

5.  Resource Record Composition

   The TIMEOUT resource record must provide expiry times for a mixed
   variety of resource record types with the same owner name and class.
   Since there could exist multiple records of the same record type with
   the same owner name and class, the TIMEOUT resource record must be
   able to identify each of these records individually with only
   different RDATA.  As an example, PTR records for service discovery
   provide a level of indirection to SRV and TXT records by instance
   name.  The instance name is stored in the PTR RDATA and multiple PTR
   records with the same owner name but only differing RDATA often
   exist.

   In order to distinguish each individual record with potentially
   different expiry times, the TIMEOUT resource record is made up
   multiple lists of hashes of the records for which they are
   applicable.  Each list has an expiry time associated with it and each
   hash corresponds to a resource record for which that expiry time
   applies.  Each resource record represented by a hash in the list uses
   the same expiry time associated with the list.  There is also a hash
   algorithm index associated with each list.  All hashes in the list
   MUST use the same hash algorithm.

   Since each TIMEOUT resource record is actually a collection of state
   from different sources over different time periods, there is a
   potential for default algorithm changes to occur on a single server
   or due to unavailability of an UPDATE server for a period of time to
   merge records between failover servers with different default
   algorithms.  Therefore, the ability to have different hash algorithms
   in the same TIMEOUT resource record is accounted for.  While this
   won't be a common scenario, it could occur during failure and restart



Pusateri & Wattenberg   Expires February 3, 2019                [Page 4]

Internet-Draft           TIMEOUT Resource Record             August 2018


   scenarios.  All hashes for the same expiry time MUST use the same
   hash algorithm.  This is not likely to cause any problems with
   merging since the same server will be using the same default hash
   algorithm at a particular second resolution in time.

5.1.  Expiry Time

   The expiry time is a 64-bit number expressed as the number of seconds
   since the UNIX epoch (00:00:00 UTC on January 1, 1970).  This value
   is an absolute time at which the record will expire.  Lease times
   must be converted to an absolute expiry time when received.

5.2.  Hash Algorithm Index

   The Hash Algorithm Index is a 16-bit value that specifies an
   identifier for the hash algorithm used.  The identifiers are declared
   in a registry maintained by IANA for the purpose of listing
   acceptable hash algorithms for this purpose.  In addition to the
   algorithm and the index, the registry will contain the output length
   in bits of the algorithm to be used.  It is conceivable, though not
   likely, that the same algorithm could be used with different output
   lengths.  In this case, each output length would require a different
   index in the registry.  Additions to this registry will be approved
   with additional documentation under expert review.  At the time that
   the registry is created by IANA, a group of expert reviewers will be
   established.

5.3.  Hash values

   The hash of each resource record is calculated using the entire
   length of the resource record as input.  The output value of the hash
   is always a fixed pre-defined length specified with the hash
   algorithm.

5.4.  Hash Requirements and Deafult Algorithm Selection

   The cryptographic hash algorithm used SHOULD provide the following
   properties:

   1.  Well known algorithm with implementations easily available.

   2.  Trusted algorithm with resistance to collision attacks.

   3.  Minimize output length for efficient storage in the TIMEOUT
       resource record.

   The initial algorithm selected to meet this criteria is SHAKE128.  It
   is part of the SHA-3 [SHA3] family of cryptographic hash algorithms.



Pusateri & Wattenberg   Expires February 3, 2019                [Page 5]

Internet-Draft           TIMEOUT Resource Record             August 2018


   The output length of the hash used is 128 bits or 16 bytes.  SHAKE128
   is implemented in the OpenSSL Library version 1.1.1 [OPENSSL].  In
   order to be in compliance with this specification, the SHAKE128
   algorithm MUST be implemented.  SHAKE128 is to be assigned an
   algorithm index of 1 in the IANA registry.

6.  TIMEOUT RR RDATA Wire Format

   The TIMEOUT resource record follows the same pattern as other DNS
   resource records as defined in Section 3.2.1 of [RFC1035].  The RDATA
   section of the resource record is illustrated in Figure 1:








































Pusateri & Wattenberg   Expires February 3, 2019                [Page 6]

Internet-Draft           TIMEOUT Resource Record             August 2018


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |    Hash Algorithm Index A     |       Hash Count A (n)        |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                      Expiry Time A (64-bit)                   |
     |                                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     .                                                               .
     .                            Hash A-1                           .
     .                                                               .
     .                                                               .
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     .                                                               .
     .                            Hash A-n                           .
     .                                                               .
     .                                                               .
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |    Hash Algorithm Index B     |       Hash Count B (m)        |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                      Expiry Time B (64-bit)                   |
     |                                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     .                                                               .
     .                            Hash B-1                           .
     .                                                               .
     .                                                               .
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     .                                                               .
     .                            Hash B-m                           .
     .                                                               .
     .                                                               .
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


                        Figure 1: RDATA Wire Format

   Figure 1 represents an arbitrary number of combinations of Hash
   Algorithm Index, Hash Count, Expiry Time, and cryptographic hashes.
   The figure entries with "A" in the name represent one instance while
   the figure entries with "B" in the name represent a second instance.
   There can be an arbitrary number of instances summed up by the RDLEN
   field in the resource record header.

   The letter "n" represents the number of cryptographic hashes present
   in the first instance where there exists 1..n hashes in the list.
   The letter "m" represents the number of cryptographic hashes present




Pusateri & Wattenberg   Expires February 3, 2019                [Page 7]

Internet-Draft           TIMEOUT Resource Record             August 2018


   in the second instance where there exists 1..m hashes in the second
   list.

7.  TIMEOUT RR RDATA Presentation Format

8.  IANA Considerations

   This document defines a new DNS Resource Record Type named TIMEOUT to
   be exchanged between authoritative master and slave DNS servers.  It
   is assigned out of the DNS Parameters Resource Record (RR) Type
   registry.  The value for the TIMEOUT resource record type is TBA.

   This document establishes a new registry of DNS Timeout Resource
   Record Cryptographic Hash Algorithms.  The registry shall include the
   name of the algorithm, the length of the output function in bits, and
   an index to be used in the RDATA section of the TIMEOUT resource
   record.

9.  Security Considerations

   Secondary servers that have received TIMEOUT resource records in a
   transfer but do not understand the record type will serve requests
   for them like any other resource record type.  This is a
   configuration error and can reveal the time that other DNS resource
   records will be present.

10.  Acknowledgements

   This idea was motivated through conversations with Mark Andrews.

11.  References

11.1.  Normative References

   [RFC1035]  Mockapetris, P., "Domain names - implementation and
              specification", STD 13, RFC 1035, DOI 10.17487/RFC1035,
              November 1987, <https://www.rfc-editor.org/info/rfc1035>.

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/info/rfc2119>.

   [RFC3597]  Gustafsson, A., "Handling of Unknown DNS Resource Record
              (RR) Types", RFC 3597, DOI 10.17487/RFC3597, September
              2003, <https://www.rfc-editor.org/info/rfc3597>.





Pusateri & Wattenberg   Expires February 3, 2019                [Page 8]

Internet-Draft           TIMEOUT Resource Record             August 2018


   [SHA3]     National Institute of Standards and Technology, "SHA-3
              Standard - Permutation-Based Hash and Extendable-Output
              Functions FIPS PUB 202", August 2015,
              <https://www.nist.gov/publications/sha-3-standard-
              permutation-based-hash-and-extendable-output-functions>.

11.2.  Informative References

   [I-D.sekar-dns-ul]
              Sekar, K., "Dynamic DNS Update Leases", draft-sekar-dns-
              ul-01 (work in progress), August 2006.

   [OPENSSL]  OpenSSL Software Foundation, "OpenSSL: Cryptography and
              SSL/TLS Toolkit", October 2017, <https://www.openssl.org>.

   [RFC2136]  Vixie, P., Ed., Thomson, S., Rekhter, Y., and J. Bound,
              "Dynamic Updates in the Domain Name System (DNS UPDATE)",
              RFC 2136, DOI 10.17487/RFC2136, April 1997,
              <https://www.rfc-editor.org/info/rfc2136>.

Authors' Addresses

   Tom Pusateri
   Unaffiliated
   Raleigh, NC
   USA

   Email: pusateri@bangj.com


   Tim Wattenberg
   Unaffiliated
   Cologne
   Germany

   Email: mail@timwattenberg.de















Pusateri & Wattenberg   Expires February 3, 2019                [Page 9]
